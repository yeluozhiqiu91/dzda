<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>交接统计</title>
    <meta name="renderer" content="webkit" />
    <link rel="stylesheet" href="assets/css/style.css" />
    <link rel="stylesheet" href="assets/plugins/jedate/jedate.css" />
</head>
<body>

<div class="wrapper">

	<!-- header begin -->
	<div class="header">
		<div class="logo">
			<a href="index.html">公安交通档案综合管理系统</a>
		</div>
		<div class="user">
			<ul>
				<li><i class="ico ico-user"></i><span>您好，赵雷</span></li>
				<li><a href="index.html"><i class="ico ico-home"></i>首页</a><i>|</i></li>
				<li><a href="notice.html"><i class="ico ico-notice"></i>通知公告</a><i>|</i></li>
				<li><a href="index.html"><i class="ico ico-edit"></i>修改资料</a><i>|</i></li>
				<li><a href="index.html"><i class="ico ico-lock"></i>修改密码</a><i>|</i></li>
				<li><a href="index.html"><i class="ico ico-logout"></i>退出</a></li>
			</ul>
		</div>
		<div class="menu">
			<div class="item" id="menu1">
				<div class="hd"><a href="#">机动车纸质档案</a></div>
				<div class="bd">
					<dl>
						<dt>
							<a href="javascript:;">
								<span>A库转B库交接</span>
								<i class="ico ico-right"></i>
							</a>
						</dt>
						<dd>
							<a href="ab1.html" id="menu1_1_1"><i class="ico ico1"></i>A库转B库登记</a>
							<a href="ab2.html" id="menu1_1_2"><i class="ico ico2"></i>A库转B库签收</a>
							<a href="ab3.html" id="menu1_1_3"><i class="ico ico3"></i>修改/补打印</a>
						</dd>
					</dl>
					<dl>
						<dt>
							<a href="javascript:;">
								<span>B库转A库交接</span>
								<i class="ico ico-right"></i>
							</a>
						</dt>
						<dd>
							<a href="ba1.html" id="menu1_2_1"><i class="ico ico1"></i>B库转A库登记</a>
							<a href="ba2.html" id="menu1_2_2"><i class="ico ico2"></i>B库转A库签收</a>
						</dd>
					</dl>
					<dl>
						<dt>
							<a href="javascript:;">
								<span>档案审核</span>
								<i class="ico ico-right"></i>
							</a>
						</dt>
						<dd>
							<a href="c.html" id="menu1_3_1"><i class="ico ico8"></i>档案审核</a>
						</dd>
					</dl>
					<dl>
						<dt>
							<a href="javascript:;">
								<span>查询统计</span>
								<i class="ico ico-right"></i>
							</a>
						</dt>
						<dd>
							<a href="d1.html" id="menu1_4_1"><i class="ico ico5"></i>档案查询</a>
							<a href="d2.html" id="menu1_4_2"><i class="ico ico6"></i>交接统计</a>
							<a href="d3.html" id="menu1_4_3"><i class="ico ico7"></i>问题档案查询</a>
						</dd>
					</dl>
				</div>
			</div>

			<div class="item" id="menu2">
				<div class="hd"><a href="#">机动车影像</a></div>
				<div class="bd">
					<dl>
						<dt>
							<a href="javascript:;">
								<span>档案影像</span>
								<i class="ico ico-right"></i>
							</a>
						</dt>
						<dd>
							<a href="e1.html" id="menu2_1_1"><i class="ico ico4"></i>历史档案影像</a>
						</dd>
					</dl>
					<dl>
						<dt>
							<a href="javascript:;">
								<span>查询统计</span>
								<i class="ico ico-right"></i>
							</a>
						</dt>
						<dd>
							<a href="f1.html" id="menu2_2_1"><i class="ico ico5"></i>影像查询</a>
							<a href="f2.html" id="menu2_2_2"><i class="ico ico6"></i>历史档案扫描流水统计</a>
							<a href="f3.html" id="menu2_2_3"><i class="ico ico7"></i>按扫描人员统计</a>
						</dd>
					</dl>
				</div>
			</div>

			<div class="item" id="menu3">
				<div class="hd"><a href="#">档案抽检</a></div>
			</div>
			<div class="item" id="menu4">
				<div class="hd"><a href="#">库房管理</a></div>
			</div>
			<div class="item" id="menu5">
				<div class="hd"><a href="#">综合查询</a></div>
			</div>
			<div class="item" id="menu6">
				<div class="hd"><a href="#">统计分析</a></div>
			</div>
			<div class="item" id="menu7">
				<div class="hd"><a href="#">系统管理</a></div>
				<div class="bd">
					<dl>
						<dt>
							<a href="javascript:;">
								<span>系统管理</span>
								<i class="ico ico-right"></i>
							</a>
						</dt>
						<dd>
							<a href="department.html" id="menu7_1_1"><i class="ico ico9"></i>部门管理</a>
							<a href="role.html" id="menu7_1_2"><i class="ico ico10"></i>角色管理</a>
							<a href="user.html" id="menu7_1_3"><i class="ico ico11"></i>用户管理</a>
						</dd>
					</dl>
				</div>
			</div>
		</div></div>
	<!-- header end -->

	<div class="content">
		<div class="crumbs">
			<a href="#">机动车纸质档案</a>
			<i>&gt;</i>
			<a href="#">查询统计</a>
			<i>&gt;</i>
			<span>交接统计</span>
		</div>

		<div class="box">
			<div class="filter">
				<form name="filterForm" id="filterForm" action="#" onsubmit="return false;" novalidate>
					<label class="for">统计时间</label>
					<input class="ipt date" name="start1" id="queryStartTime" type="text">
					<i>-</i>
					<input class="ipt date" name="end1" id="queryEndTime" type="text">
					<button type="submit" class="ubtn ubtn-primary">统计</button>
				</form>
			</div>

			<div class="table hide">
				<script id="tableTemp" type="text/html">
					{{each list as item i}}
					<tr>
						<td>{{item.id}}</td>
						<td><a href="javascript:;" data-id="{{item.id}}" class="ubtn ubtn-link department">{{item.department}}</a></td>
						<td>{{item.type}}</td>
						<td><a href="javascript:;" data-id="{{item.id}}" class="ubtn ubtn-link streamNum">{{item.streamNum}}</a></td>
						<td><a href="javascript:;" data-id="{{item.id}}" class="ubtn ubtn-link caseNum">{{item.caseNum}}</a></td>
					</tr>
					{{/each}}
				</script>
				<table class="tc">
					<thead>
						<tr>   
							<th>序号</th>
							<th>管理部门</th>
							<th>交接类型</th>
							<th>流水数量</th>
							<th>档案数量</th>
						</tr>
					</thead>
					<tbody id="tbody"></tbody>
				</table>
			</div>

			<div class="operate">
				<div class="pagination"></div>
			</div>
		</div>

		<!-- 查看管理部门 start -->
		<script id="departmentTemp" type="text/html">
			<div class="filter">
				<button type="button" class="ico ico-close fr"></button>
				<em>查看{{department}}各部门A库转B库签收数据</em>
			</div>
			<div class="table">
				<table class="tc">
					<thead>
						<tr>
							<th>序号</th>
							<th>管理部门</th>
							<th>交接类型</th>
							<th>流水数量</th>
							<th>档案数量</th>
						</tr>
					</thead>
					<tbody>
						{{each list as item i}}
						<tr>
							<td>{{item.id}}</td>
							<td>{{item.department}}</td>
							<td>{{item.type}}</td>
							<td>{{item.streamNum}}</td>
							<td>{{item.caseNum}}</td>
						</tr>
						{{/each}}
					</tbody>
				</table>
			</div>
			<div class="operate">
				<button type="button" class="ubtn ubtn-primary box-mini-close">确定</button>
			</div>
		</script>
		<div class="box box-mini hide" id="departmentBox"></div>
		<!-- 查看管理部门 end -->

		<!-- 查看流水数量 start -->
		<script id="streamNumTemp" type="text/html">
			<div class="filter">
				<button type="button" class="ico ico-close fr"></button>
				<em>查看流水号明细</em>
			</div>
			<div class="table">
				<table class="tc">
					<thead>
						<tr>
							<th>序号</th>
							<th>流水号</th>
							<th>档案编号</th>
							<th>批次号</th>
							<th>箱号</th>
							<th>登记时间</th>
							<th>操作人员</th>
						</tr>
					</thead>
					<tbody>
						{{each list as item i}}
						<tr>
							<td>{{item.id}}</td>
							<td>{{item.streamId}}</td>
							<td>{{item.caseId}}</td>
							<td>{{item.batchId}}</td>
							<td>{{item.boxId}}</td>
							<td>{{item.datetime}}</td>
							<td>{{item.operator}}</td>
						</tr>
						{{/each}}
					</tbody>
				</table>
			</div>
			<div class="operate">
				<button type="button" class="ubtn ubtn-cyan box-mini-close">关闭</button>
			</div>
		</script>
		<div class="box box-mini hide" id="streamNumBox"></div>
		<!-- 查看流水数量 end -->

		<!-- 查看档案数量 start -->
		<script id="caseTemp" type="text/html">
			<div class="filter">
				<button type="button" class="ico ico-close fr"></button>
				<em>查看档案编号明细</em>
			</div>
			<div class="table">
				<table class="tc">
					<thead>
						<tr>
							<th>序号</th>
							<th>档案编号</th>
							<th>批次号</th>
							<th>箱号</th>
							<th>签收时间</th>
							<th>操作人员</th>
						</tr>
					</thead>
					<tbody>
						{{each list as item i}}
						<tr>
							<td>{{item.id}}</td>
							<td>{{item.caseId}}</td>
							<td>{{item.batchId}}</td>
							<td>{{item.boxId}}</td>
							<td>{{item.datetime}}</td>
							<td>{{item.operator}}</td>
						</tr>
						{{/each}}
					</tbody>
				</table>
			</div>
			<div class="operate">
				<button type="button" class="ubtn ubtn-cyan box-mini-close">关闭</button>
			</div>
		</script>
		<div class="box box-mini hide" id="caseBox"></div>
		<!-- 查看档案数量 end -->
	</div>
</div>


<script src="assets/js/jquery191.js"></script>
<script src="assets/plugins/jedate/jquery.jedate.js"></script>
<script src="assets/plugins/layer/layer.js"></script>
<script src="assets/plugins/validator/jquery.validator.min.js"></script>
<script src="assets/js/art.template.js"></script>
<script src="assets/js/jquery.pagination.min.js"></script>
<script src="assets/js/common.js"></script>


<!-- 拦截ajax请求并返回虚拟数据(只做演示使用，开发时请删除) -->
<script src="assets/js/mock.js"></script>
<script>
	Mock.mock('http://g.cn', {
		"result": "SUCCESS",
	    "totalSize": 131,
	    "department": "金信融威",
	    "list|10": [{
		    "id": "@increment",
		    "department|1": ["武汉市车管所总所","金信融威"],
		    "type|1": ["A库转B库登记","A库转B库签收","B库转A库登记","B库转A库签收"],
		    "streamNum|600-1000": 1,
		    "caseNum|100-300": 1
		}]
	});
	Mock.mock('http://s.cn', {
		"result": "SUCCESS",
	    "totalSize": 131,
	    "list|10": [{
		    "id": "@increment",
		    "streamId": "201648277278",
		    "caseId": "420115003544",
		    "batchId": "20170717000017",
		    "boxId": "WUH0430521",
		    "datetime": "@datetime",
		    "operator": "@cname"
		}]
	});
</script>
<!-- 拦截ajax请求并返回虚拟数据(只做演示使用，开发时请删除) end -->


<script>

var _pageInit = {
	init: function() {
		menu('menu1_4_2');
		this.filter();
		this.bindEvent();
		this.jeDate();
	},
	jeDate: function() {
		var start = {
		    format: 'YYYY-MM-DD hh:mm',
		    maxDate: $.nowDate({DD:0}), //最大日期
		    choosefun: function(elem,datas){
		        end.minDate = datas; //开始日选好后，重置结束日的最小日期
			    end.trigger = false;
			    $("#queryEndTime").jeDate(end);
		    }
		};
		var end = {
		    format: 'YYYY-MM-DD hh:mm',
		    maxDate: $.nowDate({DD:0}), //最大日期
		    choosefun: function(elem,datas){
		        start.maxDate = datas; //将结束日的初始值设定为开始日的最大日期
		    }
		};
		$("#queryStartTime").jeDate(start);
		$("#queryEndTime").jeDate(end);
	},
	filter: function() {
		var that = this;
		var $form = $('#filterForm');
		var page =  new Page({
			pageIndex: 1, // 当前页
			pageSize: 10, // 每页显示10条
			url: 'http://g.cn'
		})

		// 查询
		$form.on('submit', function() {
			var filterData = $form.serializeArray();
			page.request(filterData);
			return false;
		})
	},
	bindEvent: function() {
		var that = this,
			$tbody = $('#tbody');

		// 管理部门
		$tbody.on('click', '.department', function() {
			var id = $(this).data('id');
			fx.request('http://g.cn', {id: id}, function(res) {
				var model = template('departmentTemp', res);
				$('#departmentBox').empty().html(model).show().siblings('.box').hide();
			})
		})
		// 流水数量
		$tbody.on('click', '.streamNum', function() {
			var id = $(this).data('id');
			fx.request('http://s.cn', {id: id}, function(res) {
				fx.log(res)
				var model = template('streamNumTemp', res);
				$('#streamNumBox').empty().html(model).show().siblings('.box').hide();
			})
		})
		// 档案数量
		$tbody.on('click', '.caseNum', function() {
			var id = $(this).data('id');
			fx.request('http://s.cn', {id: id}, function(res) {
				fx.log(res)
				var model = template('caseTemp', res);
				$('#caseBox').empty().html(model).show().siblings('.box').hide();
			})
		})

	}
}

</script>
</body>
</html>